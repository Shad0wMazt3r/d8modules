<?php
function links_block_block_info() {
  $blocks['links_block'] = array(
    'info' => t('Links Block'),
    'cache' => DRUPAL_CACHE_PER_ROLE,
  );
  return $blocks;
}

function links_block_block_view($delta = '') {
  $block = array();
  switch ($delta) {
    case 'links_block':
      $block = array(
        '#markup' => '',
        '#contextual_links' => array(
          'block' => array(
            'route_parameters' => array('block_id' => 'links_block'),
          ),
        ),
      );
      break;
  }
  return $block;
}


// function links_block_block_view($delta = '') {
//   $block = array();
//   switch ($delta) {
//     case 'links_block':
//       $block = array(
//         'subject' => t('Links Block'),
//         'contextual links' => array(
//           'links_block' => array(
//             '#type' => 'contextual_links',
//             '#contextual_links' => array(
//               'block' => array(
//                 'route_parameters' => array('block_id' => 'links_block'),
//               ),
//             ),
//           ),
//         ),
//       );
//       break;
//   }
//   return $block;
// }


// function links_block_block_view($delta = '') {
//   $block = array();
//   switch ($delta) {
//     case 'links_block':
//       $block = array(
//         'subject' => t('Links Block'),
//         'content' => array(
//           '#markup' => 'This is Links Block content.',
//         ),
//         'contextual links' => array(
//           'links_block' => array(
//             'edit' => array(
//               'href' => 'admin/structure/block/manage/links_block',
//               'localized_options' => array(
//                 'attributes' => array(
//                   'title' => t('Edit Links Block'),
//                 ),
//               ),
//             ),
//           ),
//         ),
//       );
//       break;
//   }
//   return $block;
// }

function links_block_theme_suggestions_block_alter(&$suggestions, $variables) {
  $content = $variables['elements']['content'];
  if (isset($content['#block_content']) && $content['#block_content'] instanceof \Drupal\block_content\BlockContentInterface) {
    $suggestions[] = 'block__' . $content['#block_content']->bundle();
  }
}

function links_block_block_configure($delta = '') {
  $form = array();
  switch ($delta) {
    case 'links_block':
      $form['subject'] = array(
        '#type' => 'textfield',
        '#title' => t('Block title'),
        '#default_value' => theme_get_setting('links_block_subject'),
      );
      break;
  }
  return $form;
}

function links_block_block_save($delta = '', $edit = array()) {
  switch ($delta) {
    case 'links_block':
      theme_get_setting('links_block_subject', $edit['subject']);
      break;
  }
}

// function links_block_block_configure($delta = '') {
//   $block = array();
//   switch ($delta) {
//     case 'links_block':
//       $block = array(
//         'subject' => t('Links Block'),
//         'content' => array(
//           '#markup' => 'This is Links Block content.',
//         ),
//         'contextual links' => array(
//           $delta => array(
//             'edit' => array(
//               'href' => 'admin/structure/block/manage/' . $delta,
//               'localized_options' => array(
//                 'attributes' => array(
//                   'title' => t('Edit Links Block'),
//                 ),
//               ),
//             ),
//           ),
//         ),
//       );
//       break;
//     default:
//       return array();
//   }
//   return $block;
// }

// function links_block_theme_suggestions_block_alter(&$suggestions, $variables) {
//   $content = $variables['elements']['content'];
//   if (isset($content['#block_content']) && $content['#block_content'] instanceof \Drupal\block_content\BlockContentInterface) {
//     $suggestions[] = 'block__' . $content['#block_content']->bundle();
//   }
// }

?>
